<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Demographic Projection • caribouMetrics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Demographic Projection">
<meta property="og:description" content="caribouMetrics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caribouMetrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/caribouDemography.html">Caribou Demography</a>
    </li>
    <li>
      <a href="../articles/BayesianDemographicProjection.html">Bayesian Demographic Projection</a>
    </li>
    <li>
      <a href="../articles/Using_disturbanceMetric.html">Disturbance Metrics</a>
    </li>
    <li>
      <a href="../articles/Using_caribouHabitat.html">Using caribouHabitat</a>
    </li>
    <li>
      <a href="../articles/UI_help.html">User Interface Help</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LandSciTech/caribouMetrics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bayesian Demographic Projection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LandSciTech/caribouMetrics/blob/HEAD/vignettes/BayesianDemographicProjection.Rmd" class="external-link"><code>vignettes/BayesianDemographicProjection.Rmd</code></a></small>
      <div class="hidden name"><code>BayesianDemographicProjection.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://landscitech.github.io/caribouMetrics">caribouMetrics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>caribouMetrics provides a simple Bayesian population model that
integrates prior information from Johnson et al.’s (2020) national
analysis of demographic-disturbance relationships with available local
demographic data to project population growth. In addition, methods are
provided for simulating local population dynamics and monitoring
programs. These tools are also available through a shiny app described
<a href="#Use-the-Bayesian-demographic-projection-app">below</a>.</p>
<p>Boreal caribou monitoring programs typically involve marking caribou
with telemetry GPS/VHF collars which are used to monitor caribou over
time and detect the death of marked animals. This data is then used to
estimate survival, while recruitment is estimated by locating collared
individuals using aircraft and then surveying the entire group of
caribou to estimate the ratio of cows:calves in the group. Because this
estimate is based on more than just the sample of collared cows, the
sample size for recruitment estimates is typically larger than for
survival.</p>
<div class="section level3">
<h3 id="integration-of-local-demographic-data-and-national-disturbance-demographic-relationships-in-a-bayesian-population-model">Integration of local demographic data and national
disturbance-demographic relationships in a Bayesian population
model<a class="anchor" aria-label="anchor" href="#integration-of-local-demographic-data-and-national-disturbance-demographic-relationships-in-a-bayesian-population-model"></a>
</h3>
<p>Following Eacker et al. (2019), the observed number of calves <span class="math inline">\(\hat{J}_t\)</span> is a binomially distributed
function of the observed number of adult female caribou <span class="math inline">\(\hat{W}_t\)</span> and the estimated recruitment
rate <span class="math inline">\(R_t\)</span>: <span class="math display">\[\hat{J}_t \sim
\text{Binomial}(\hat{W}_t,R_t).\]</span></p>
<p>We model recruitment probability as a function of anthropogenic
disturbance and fire with a log link (Dyson et al., 2022; Johnson et
al., 2020; Stewart et al., 2023) and Gaussian distributed random year
effect (Eacker et al., 2019): <span class="math display">\[\log(R_t)=\beta^R_0+\beta^R_a A_t+\beta^R_f
F_t+\epsilon^R_t; \epsilon^R_t
\sim \text{Normal}(0,\sigma^2_{R}).\]</span> Estimated recruitment
probability is adjusted for sex ratio, misidentification biases, and age
of first reproduction (DeCesare et al., 2012; Eacker et al., 2019) to
get expected recruits per female: <span class="math display">\[X_t=\frac{cR_t/2}{1+cR_t/2};
c=\frac{w(1+qu-u)}{(w+qu-u)(1-z)}.\]</span> The composition survey bias
correction term <span class="math inline">\(c\)</span> depends on the
apparent number of adult females per collared animal <span class="math inline">\(w\)</span>, the ratio of young bulls to adult
females <span class="math inline">\(q\)</span>, the probability of
misidentifying young bulls as adult females and vice versa <span class="math inline">\(u\)</span>, and the probability of missing a calf
<span class="math inline">\(z\)</span> (see
<code><a href="../reference/compositionBiasCorrection.html">compositionBiasCorrection()</a></code>). To maintain consistency with
Johnson et al. (2020) we also provide an option
(<code>adjustR = FALSE</code>) to only adjust for sex ratio and
misidentification biases <span class="math inline">\(X_t=cR_t/2\)</span>.</p>
<p>In the Bayesian model, prior uncertainty about the value of the bias
correction term <span class="math inline">\(c\)</span> is approximated
with a Log-normal distribution. Given the apparent number of adult
females per collared animal <span class="math inline">\(w\)</span>, the
mean and standard deviation of 10,000 samples of <span class="math inline">\(\log{c}\)</span> is calculated with the default
being to assume the ratio of young bulls to adult females <span class="math inline">\(q\)</span> varies uniformly between 0 and 0.6, the
adult misidentification probability <span class="math inline">\(u\)</span> varies uniformly between 0 and 0.2, and
the probability of missing a calf <span class="math inline">\(z\)</span>
varies uniformly between 0 and 0.2 (see <code><a href="../reference/getPriors.html">getPriors()</a></code>).</p>
<p>Also following Eacker et al. (2019), Kaplan-Meier estimates of
observed adult female survival probability <span class="math inline">\(\hat{S}_t\)</span> and associated precisions <span class="math inline">\(\tau_t\)</span> are estimated from known-fate
radio collar data using the <a href="https://CRAN.R-project.org/package=survival" class="external-link">survival</a> package,
with precisions for years with no observed mortality estimated using a
separate Bayesian model. Observed estimated survival is a Gaussian
distributed function of the true survival probability: <span class="math display">\[\hat{S_t} \sim
\text{Normal}(S_t,1/\tau_t).\]</span> As in the national demographic
model, we model survival probability as an adjusted function of buffered
anthropogenic disturbance <span class="math inline">\(A_t\)</span> with
a log link (Dyson et al., 2022; Johnson et al., 2020; Stewart et al.,
2023) and Gaussian distributed random year effect (Eacker et al., 2019):
<span class="math display">\[S_t=\text{min}(46 \tilde{S_t}-0.5)/45,1);
\log(\tilde{S_t})=\beta^S_0+\beta^S_a A_t+\epsilon^S_t; \epsilon^S_t
\sim \text{Normal}(0,\sigma^2_{S}).\]</span> To handle cases in which
there is little or no survival data, we also implemented an alternative
parametric exponential survival model, wherein the observed state (alive
or dead, <span class="math inline">\(\hat{I}_{i,t,m}\)</span>) of an
individual animal <span class="math inline">\(i\)</span> in year <span class="math inline">\(t\)</span> and month <span class="math inline">\(m\)</span> is Bernoulli distributed (Schaub and
Kery, 2021): <span class="math display">\[\hat{I}_{i,t,m} \sim
\text{Bernoulli}(S^{1/12}_t\hat{I}_{i,t,m-1}).\]</span> The exponential
survival method can be used in all cases instead of the Kaplan-Meier
method by setting <code>survAnalysisMethod = "Exponential"</code>.</p>
<p>All regression coefficients are assumed to be Gaussian distributed,
with priors derived from the expected values and 95% confidence
intervals estimated by Johnson et al (2020)
(<code>popGrowthTableJohnsonECCC</code>). We calibrated the prior
distributions so that the 95% prior prediction intervals for survival
and recruitment from the Bayesian model match the range between the 2.5%
and 97.5% quantiles of 1000 simulated survival and recruitment
trajectories (see <code><a href="../reference/getPriors.html">getPriors()</a></code>).</p>
<div class="section level4">
<h4 id="using-real-observed-data">Using real observed data<a class="anchor" aria-label="anchor" href="#using-real-observed-data"></a>
</h4>
<p>caribouMetrics includes example csv files of collar survival and calf
cow count data as well as disturbance data that can be used as templates
for the format for observed data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survObs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/simSurvData.csv"</span>, package <span class="op">=</span> <span class="st">"caribouMetrics"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ageRatioObs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/simAgeRatio.csv"</span>, package <span class="op">=</span> <span class="st">"caribouMetrics"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">distObs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/simDisturbance.csv"</span>, package <span class="op">=</span> <span class="st">"caribouMetrics"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">survObs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n_collars <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            n_die <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">event</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">n_collars</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">n_die</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number of Collars (line) and deaths (bars)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/load-obs-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ageRatioObs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Count</span>, fill <span class="op">=</span> <span class="va">Class</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/load-obs-2.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">distObs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Anthro</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/load-obs-3.png" width="672">
Plotting the data shows that the collaring program included 60
individuals with collars being replenished every 3 years over a
monitoring period of 15 years. Calf cow surveys typically counted ~150
cows and ~50 calves. There is no disturbance in the years of the
observation data but disturbance is expected to increase quickly in the
future.</p>
<p>These data sets can be supplied to
<code><a href="../reference/caribouBayesianIPM.html">caribouBayesianIPM()</a></code>to project the impact on the caribou
population as disturbance increases over the next 20 years.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_real</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caribouBayesianIPM.html">caribouBayesianIPM</a></span><span class="op">(</span>survData <span class="op">=</span> <span class="va">survObs</span>, ageRatio <span class="op">=</span> <span class="va">ageRatioObs</span>, </span>
<span>                              disturbance <span class="op">=</span> <span class="va">distObs</span>, </span>
<span>                              <span class="co"># only set to speed up vignette. Normally keep defaults.</span></span>
<span>                              Niter <span class="op">=</span> <span class="fl">150</span>, Nburn <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mod_real</span>, max.level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ result:List of 6</span></span>
<span><span class="co">#&gt;   ..$ model             :List of 8</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "jags"</span></span>
<span><span class="co">#&gt;   ..$ BUGSoutput        :List of 24</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "class")= chr "bugs"</span></span>
<span><span class="co">#&gt;   ..$ parameters.to.save: chr [1:12] "S.annual.KM" "R" "Rfemale" "pop.growth" ...</span></span>
<span><span class="co">#&gt;   ..$ model.file        : chr "/tmp/Rtmp36k7yU/JAGS_run.txt"</span></span>
<span><span class="co">#&gt;   ..$ n.iter            : num 150</span></span>
<span><span class="co">#&gt;   ..$ DIC               : logi TRUE</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr "rjags"</span></span>
<span><span class="co">#&gt;  $ inData:List of 3</span></span>
<span><span class="co">#&gt;   ..$ survDataIn   :'data.frame':    35 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;   ..$ disturbanceIn:'data.frame':    35 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;   ..$ ageRatioIn   :'data.frame':    70 obs. of  4 variables:</span></span></code></pre></div>
<p>The returned object contains an <code>rjags</code> object and a list
with the modified input data. We can get tables summarizing the results
using <code><a href="../reference/getOutputTables.html">getOutputTables()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getOutputTables.html">getOutputTables</a></span><span class="op">(</span><span class="va">mod_real</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mod_tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ rr.summary.all:'data.frame':  175 obs. of  13 variables:</span></span>
<span><span class="co">#&gt;   ..$ Year            : int [1:175] 2009 2009 2009 2009 2009 2010 2010 2010 2010 2010 ...</span></span>
<span><span class="co">#&gt;   ..$ Parameter       : chr [1:175] "Adjusted recruitment" "Adult female survival" "Recruitment" "Female population size" ...</span></span>
<span><span class="co">#&gt;   ..$ Mean            : num [1:175] 0.222 0.892 0.422 1000 1.089 ...</span></span>
<span><span class="co">#&gt;   ..$ SD              : num [1:175] 0.023 0.018 0.029 0 0.04 ...</span></span>
<span><span class="co">#&gt;   ..$ Lower 95% CRI   : num [1:175] 0.182 0.858 0.372 1000 1.024 ...</span></span>
<span><span class="co">#&gt;   ..$ Upper 95% CRI   : num [1:175] 0.268 0.926 0.478 1000 1.166 ...</span></span>
<span><span class="co">#&gt;   ..$ probViable      : num [1:175] NA NA NA NA 1 NA NA NA NA 0.98 ...</span></span>
<span><span class="co">#&gt;   ..$ X               : int [1:175] 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;   ..$ Anthro          : int [1:175] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ fire_excl_anthro: num [1:175] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ Total_dist      : num [1:175] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ time            : int [1:175] 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;   ..$ param           : chr [1:175] "observed" "observed" "observed" "observed" ...</span></span>
<span><span class="co">#&gt;  $ sim.all       : NULL</span></span>
<span><span class="co">#&gt;  $ obs.all       :'data.frame':  70 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;   ..$ Year            : num [1:70] 2009 2009 2010 2010 2011 ...</span></span>
<span><span class="co">#&gt;   ..$ Mean            : num [1:70] 0.446 0.817 0.857 0.319 0.833 ...</span></span>
<span><span class="co">#&gt;   ..$ parameter       : chr [1:70] "Recruitment" "Adult female survival" "Adult female survival" "Recruitment" ...</span></span>
<span><span class="co">#&gt;   ..$ type            : chr [1:70] "observed" "observed" "observed" "observed" ...</span></span>
<span><span class="co">#&gt;   ..$ X               : int [1:70] 1 1 2 2 3 3 4 4 5 5 ...</span></span>
<span><span class="co">#&gt;   ..$ Anthro          : int [1:70] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ fire_excl_anthro: num [1:70] 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ Total_dist      : num [1:70] 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;   ..$ time            : int [1:70] 1 1 2 2 3 3 4 4 5 5 ...</span></span>
<span><span class="co">#&gt;   ..$ param           : chr [1:70] "observed" "observed" "observed" "observed" ...</span></span>
<span><span class="co">#&gt;  $ ksDists       :'data.frame':  175 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;   ..$ Year      : int [1:175] 2009 2009 2009 2009 2009 2010 2010 2010 2010 2010 ...</span></span>
<span><span class="co">#&gt;   ..$ Parameter : chr [1:175] "Adjusted recruitment" "Adult female survival" "Recruitment" "Female population size" ...</span></span>
<span><span class="co">#&gt;   ..$ KSDistance: logi [1:175] NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..$ KSpvalue  : logi [1:175] NA NA NA NA NA NA ...</span></span></code></pre></div>
<p>And plot the results with <code><a href="../reference/plotRes.html">plotRes()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotRes.html">plotRes</a></span><span class="op">(</span><span class="va">mod_tbl</span>, <span class="st">"Recruitment"</span>, labFontSize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>We can also compare our local observed data to what would be
projected by the national model with out considering local population
specific data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simNational</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSimsNational.html">getSimsNational</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Setting expected survival S_bar to be between l_S and h_S.</span></span>
<span><span class="co">#&gt; Updating cached national simulations.</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mod_nat_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getOutputTables.html">getOutputTables</a></span><span class="op">(</span><span class="va">mod_real</span>, </span>
<span>                               simNational <span class="op">=</span> <span class="va">simNational</span>,</span>
<span>                               getKSDists <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotRes.html">plotRes</a></span><span class="op">(</span><span class="va">mod_nat_tbl</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Recruitment"</span>, <span class="st">"Adult female survival"</span>, <span class="st">"Population growth rate"</span><span class="op">)</span>,</span>
<span>        labFontSize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Recruitment</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Adult female survival`</span></span></code></pre>
<p><img src="BayesianDemographicProjection_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Population growth rate`</span></span></code></pre>
<p><img src="BayesianDemographicProjection_files/figure-html/unnamed-chunk-4-3.png" width="672"></p>
<p>From these graphs we can see that this local population seems to have
slightly higher demographic rates than would have been predicted by the
national model alone and that the uncertainty around the predictions is
lower when the local observations are included. Note that the
population’s response to anthropogenic disturbance is completely
determined by the national model since there was 0% disturbance during
the observation period.</p>
</div>
</div>
<div class="section level3">
<h3 id="simulation-of-local-population-dynamics-and-monitoring">Simulation of local population dynamics and monitoring<a class="anchor" aria-label="anchor" href="#simulation-of-local-population-dynamics-and-monitoring"></a>
</h3>
<p>To simulate plausible demographic trajectories for example
populations we used a modified version of Johnson et al’s (2020)
two-stage demographic model described by Dyson et al. (2022). The true
number of post-juvenile females that survive from year <span class="math inline">\(t\)</span> to the census, <span class="math inline">\(\dot{W}_t\)</span>, is binomially distributed with
true survival probability <span class="math inline">\(\dot{S}_t\)</span>: <span class="math inline">\(\dot{W}_{t} \sim
\text{Binomial}(\dot{N}_t,\dot{S}_t)\)</span>. Maximum potential
recruitment rate is adjusted for sex ratio, misidentification biases and
(optionally) delayed age at first reproduction (DeCesare et al., 2012;
Eacker et al., 2019): <span class="math display">\[\dot{X}_t=\frac{c\dot{R}_t/2}{1+c\dot{R}_t/2};c=\frac{w(1+qu-u)}{(w+qu-u)(1-z)},
\]</span> where <span class="math inline">\(w\)</span> is a multiplier
that defines the apparent number of adult females in the composition
survey as a function of the number of collared animals, <span class="math inline">\(q\)</span> is the ratio of young bulls to adult
females, <span class="math inline">\(u\)</span> is the probability of
misidentifying young bulls as adult females and vice versa, and <span class="math inline">\(z\)</span> is the probability of missing a
calf.</p>
<p>Realized recruitment rate varies with population density (Lacy et
al., 2017), and the number of juveniles recruiting to the post-juvenile
class at the census is a binomially distributed function of the number
of surviving post-juvenile females and the adjusted recruitment rate:
<span class="math display">\[\dot{J}_{t} \sim
\text{Binomial}(\dot{W}_t,\dot{X}_t[p_0-(p_0-p_k)(\frac{\dot{W}_t}{N_0k})^b]\frac{\dot{W}_t}{\dot{W}_t+a}).\]</span>
Given default parameters, recruitment rate is lowest <span class="math inline">\((0.5\dot{X}_t)\)</span> when <span class="math inline">\(\dot{N}_t=1\)</span>, approaches a maximum of
<span class="math inline">\(\dot{X}_t\)</span> at intermediate
population sizes, and declines to <span class="math inline">\(0.6\dot{X}_t\)</span> as the population reaches
carrying capacity of <span class="math inline">\(k=100\)</span> times
the initial population size. The post-juvenile female population in the
next year includes both survivors and new recruits: <span class="math inline">\(\dot{N}_{t+1}=\text{min}(\dot{W}_t+\dot{J}_t,r_{max}\dot{N}_t)\)</span>.</p>
<p>Interannual variation in survival and recruitment is modelled using
truncated beta distributions (rtrunc function; Novomestky and Nadarajah
(2016)): <span class="math inline">\(\dot{R}_t \sim
\text{TruncatedBeta}(\bar{R}_t,\nu_R,l_R,h_R); \dot{S}_t \sim
\text{TruncatedBeta}(\bar{S}_t,\nu_S,l_S,h_S)\)</span>. Coefficients of
variation among years <span class="math inline">\((\nu_R,\nu_S)\)</span>
and maximum/minimum values <span class="math inline">\(l_R,h_R,l_S,h_S\)</span> for recruitment and
survival have default values set in <code><a href="../reference/caribouPopGrowth.html">caribouPopGrowth()</a></code>.
Expected recruitment (<span class="math inline">\(\bar{R}_t\)</span>)
and survival (<span class="math inline">\(\bar{S}_t\)</span>) vary with
disturbance according the beta regression models estimated by Johnson et
al. (2020: <span class="math display">\[ \bar{R}_t \sim
Beta(\mu^R_t,\phi^R);log(\mu^R_t)=\dot{\beta^R_0}+\dot{\beta^R_a}A_t+\dot{\beta}^R_fF_t,\]</span>
<span class="math display">\[\bar{S}_t \sim (46\times
Beta(\mu^S_t,\phi^S)-0.5)/45;log(\mu^S_t)=\dot{\beta^S_0}+\dot{\beta^S_a}A_t.\]</span>
<span class="math inline">\(\phi^R \sim
\text{Normal}(19.862,2.229)\)</span> and <span class="math inline">\(\phi^S \sim \text{Normal}(63.733,8.311)\)</span>
are precisions of the Beta distributed errors (Ferrari and Cribari-Neto,
2004). At the beginning of a simulation for an example population,
regression coefficient values are sampled from Gaussian distributions
(see <code><a href="../reference/demographicRates.html">demographicRates()</a></code>) and the population is assigned to
quantiles of the Beta error distributions for survival and recruitment.
The population remains in these quantiles as disturbance changes over
time, so there is substantial persistent variation in recruitment and
survival among example populations.</p>
<div class="section level4">
<h4 id="observed-survival-of-collared-animals">Observed survival of collared animals<a class="anchor" aria-label="anchor" href="#observed-survival-of-collared-animals"></a>
</h4>
<p>In our simulated populations, mortality risk does not vary over time
or among individuals, so the observed state (dead or alive) of a
collared animal <span class="math inline">\(i\)</span> in month <span class="math inline">\(m\)</span> and year <span class="math inline">\(t\)</span> depends on the true survival rate <span class="math inline">\(\dot{S}_t\)</span> as follows: <span class="math display">\[\hat{I}_{i,t,m} \sim
\text{Bernoulli}(\dot{S}^{1/12}_t\hat{I}_{i,t,m-1}).\]</span></p>
</div>
<div class="section level4">
<h4 id="observed-recruitment-from-composition-surveys">Observed recruitment from composition surveys<a class="anchor" aria-label="anchor" href="#observed-recruitment-from-composition-surveys"></a>
</h4>
<p>The number of cows in the composition survey <span class="math inline">\(\hat{W}_t\)</span> is given by the number of
collared cows <span class="math inline">\(\hat{T}_t\)</span> and the
apparent number of adult females per collared female observed in the
composition survey <span class="math inline">\(w\)</span>: <span class="math display">\[\hat{W}_t = w\hat{T}_t.\]</span> The number of
observed calves <span class="math inline">\(\hat{J}_t\)</span> also
depends on the unadjusted apparent recruitment for the population <span class="math inline">\(\dot{R}_t\)</span>: <span class="math display">\[\hat{J}_t \sim
\text{Binomial}(\hat{W}_t,\dot{R}_t).\]</span></p>
</div>
<div class="section level4">
<h4 id="using-simulated-observed-data">Using simulated observed data<a class="anchor" aria-label="anchor" href="#using-simulated-observed-data"></a>
</h4>
<p>To run the simulations we need to supply parameters that determine
the disturbance scenario, the trajectory of the true population relative
to the national model mean, and the collaring program details. All these
parameters are set with <code><a href="../reference/getScenarioDefaults.html">getScenarioDefaults()</a></code> which will
create a table with the default values of all parameters and override
the defaults for any values that are supplied. Below we define a
scenario where we have 20 years of observations and 20 years of
projection, increasing anthropogenic disturbance over time, and 30
collars deployed every year. We assume that 2 cows will be observed in
aerial surveys for every collared cow. The default values are set for
our simulated true population meaning that we assume the population has
the same response to disturbance as the national model and that the
population demographic rates are close to the national average. See
<code><a href="../reference/getScenarioDefaults.html">getScenarioDefaults()</a></code> for a detailed description of each
parameter.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scn_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getScenarioDefaults.html">getScenarioDefaults</a></span><span class="op">(</span></span>
<span>  <span class="co"># Anthropogenic disturbance increases by 2% per year in observation period and</span></span>
<span>  <span class="co"># 3% per year in projection period</span></span>
<span>  obsAnthroSlope <span class="op">=</span> <span class="fl">2</span>, projAnthroSlope <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  <span class="co"># 20 years each of observations and projections</span></span>
<span>  obsYears <span class="op">=</span> <span class="fl">20</span>, projYears <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="co"># Collaring program aims to keep 30 collars active</span></span>
<span>  collarCount <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  <span class="co"># Collars are topped up every year</span></span>
<span>  collarInterval <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="co"># Assume will see 2 cows in aerial survey for every collar deployed</span></span>
<span>  cowMult <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">scn_params</span></span>
<span><span class="co">#&gt;   iFire iAnthro obsAnthroSlope projAnthroSlope rSlopeMod sSlopeMod rQuantile</span></span>
<span><span class="co">#&gt; 1     0       0              2               3         1         1       0.5</span></span>
<span><span class="co">#&gt;   sQuantile projYears obsYears preYears   N0 adjustR assessmentYrs qMin qMax</span></span>
<span><span class="co">#&gt; 1       0.5        20       20        0 1000    TRUE             3    0  0.6</span></span>
<span><span class="co">#&gt;   uMin uMax zMin zMax cowMult collarInterval collarCount curYear ID</span></span>
<span><span class="co">#&gt; 1    0  0.2    0  0.2       2              1          30    2023  1</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                   label</span></span>
<span><span class="co">#&gt; 1 ID1_curYear2023_collarCount30_collarInterval1_cowMult2_zMax0.2_zMin0_uMax0.2_uMin0_qMax0.6_qMin0_assessmentYrs3_adjustRTRUE_N01000_preYears0_obsYears20_projYears20_sQuantile0.5_rQuantile0.5_sSlopeMod1_rSlopeMod1_projAnthroSlope3_obsAnthroSlope2_iAnthro0_iFire0_</span></span>
<span><span class="co">#&gt;   startYear</span></span>
<span><span class="co">#&gt; 1      2004</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sim_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateObservations.html">simulateObservations</a></span><span class="op">(</span></span>
<span>  <span class="va">scn_params</span>, </span>
<span>  <span class="co"># collars fall off after 4 years and are deployed in May and fall off in August</span></span>
<span>  collarNumYears <span class="op">=</span> <span class="fl">4</span>, collarOffTime <span class="op">=</span> <span class="fl">8</span>, collarOnTime <span class="op">=</span> <span class="fl">5</span>, </span>
<span>  printPlot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/sim-obs-1.png" width="672"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">sim_obs</span><span class="op">$</span><span class="va">simSurvObs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>ncollar <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, ndeaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">event</span><span class="op">)</span>, </span>
<span>            ndropped <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">exit</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">event</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>            nadded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">enter</span> <span class="op">==</span> <span class="fl">7</span><span class="op">)</span>, </span>
<span>            survsCalving <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">exit</span> <span class="op">&gt;=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ncollar</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ndeaths</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Number of Collars (line) and deaths (bars)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/sim-obs-2.png" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sim_obs</span><span class="op">$</span><span class="va">ageRatioOut</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Count</span>, fill <span class="op">=</span> <span class="va">Class</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/sim-obs-3.png" width="672"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sim_obs</span><span class="op">$</span><span class="va">simDisturbance</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Year</span>, <span class="va">Anthro</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/sim-obs-4.png" width="672"></p>
<p>We can provide the simulated observations to
<code><a href="../reference/caribouBayesianIPM.html">caribouBayesianIPM()</a></code> to project the population growth over
time. This time we supply the expected true population metrics as well
as the model results to <code><a href="../reference/getOutputTables.html">getOutputTables()</a></code> so that we can
see how well our monitoring program captured the true population.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/caribouBayesianIPM.html">caribouBayesianIPM</a></span><span class="op">(</span>survData <span class="op">=</span> <span class="va">sim_obs</span><span class="op">$</span><span class="va">simSurvObs</span>,</span>
<span>                              ageRatio <span class="op">=</span> <span class="va">sim_obs</span><span class="op">$</span><span class="va">ageRatioOut</span>, </span>
<span>                              disturbance <span class="op">=</span> <span class="va">sim_obs</span><span class="op">$</span><span class="va">simDisturbance</span>, </span>
<span>                              <span class="co"># only set to speed up vignette. Normally keep defaults.</span></span>
<span>                              Niter <span class="op">=</span> <span class="fl">150</span>, Nburn <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mod_sim_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getOutputTables.html">getOutputTables</a></span><span class="op">(</span><span class="va">mod_sim</span>, exData <span class="op">=</span> <span class="va">sim_obs</span><span class="op">$</span><span class="va">exData</span>, </span>
<span>                               paramTable <span class="op">=</span> <span class="va">sim_obs</span><span class="op">$</span><span class="va">paramTable</span>,</span>
<span>                               simNational <span class="op">=</span> <span class="va">simNational</span>,</span>
<span>                               getKSDists <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plotRes.html">plotRes</a></span><span class="op">(</span><span class="va">mod_sim_tbl</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Recruitment"</span>, <span class="st">"Adult female survival"</span>, <span class="st">"Population growth rate"</span><span class="op">)</span>,</span>
<span>        labFontSize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Recruitment</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/mod-sim-obs-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Adult female survival`</span></span></code></pre>
<p><img src="BayesianDemographicProjection_files/figure-html/mod-sim-obs-2.png" width="672"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Population growth rate`</span></span></code></pre>
<p><img src="BayesianDemographicProjection_files/figure-html/mod-sim-obs-3.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="comparing-many-scenarios">Comparing many scenarios<a class="anchor" aria-label="anchor" href="#comparing-many-scenarios"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eParsIn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">eParsIn</span><span class="op">$</span><span class="va">collarOnTime</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">eParsIn</span><span class="op">$</span><span class="va">collarOffTime</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">eParsIn</span><span class="op">$</span><span class="va">collarNumYears</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># adjust recruitment for delayed age of first reproduction</span></span>
<span><span class="va">adjustR</span> <span class="op">&lt;-</span> <span class="cn">T</span> </span>
<span></span>
<span><span class="va">simBig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSimsNational.html">getSimsNational</a></span><span class="op">(</span>adjustR <span class="op">=</span> <span class="va">adjustR</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using saved object</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">scns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>  obsYears <span class="op">=</span> <span class="fl">10</span>, projYears <span class="op">=</span> <span class="fl">10</span>, collarCount <span class="op">=</span> <span class="fl">100</span>, cowMult <span class="op">=</span> <span class="fl">2</span>, collarInterval <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  assessmentYrs <span class="op">=</span> <span class="fl">1</span>, iAnthro <span class="op">=</span> <span class="fl">0</span>, obsAnthroSlope <span class="op">=</span> <span class="fl">0</span>, projAnthroSlope <span class="op">=</span> <span class="fl">0</span>, </span>
<span>  sQuantile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span>, rQuantile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span>, N0 <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span><span class="va">scResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runScnSet.html">runScnSet</a></span><span class="op">(</span></span>
<span>  <span class="va">scns</span>, <span class="va">eParsIn</span>, <span class="va">simBig</span>, getKSDists <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="co"># only set to speed up vignette. Normally keep defaults.</span></span>
<span>  Niter <span class="op">=</span> <span class="fl">150</span>, Nburn <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; Warning in caribouBayesianIPM(survData = oo$simSurvObs, ageRatio =</span></span>
<span><span class="co">#&gt; oo$ageRatioOut, : warning, low sample size of adult females in at least one</span></span>
<span><span class="co">#&gt; year</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; Warning in caribouBayesianIPM(survData = oo$simSurvObs, ageRatio =</span></span>
<span><span class="co">#&gt; oo$ageRatioOut, : warning, low sample size of adult females in at least one</span></span>
<span><span class="co">#&gt; year</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; Warning in caribouBayesianIPM(survData = oo$simSurvObs, ageRatio =</span></span>
<span><span class="co">#&gt; oo$ageRatioOut, : warning, low sample size of adult females in at least one</span></span>
<span><span class="co">#&gt; year</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; Warning in caribouBayesianIPM(survData = oo$simSurvObs, ageRatio =</span></span>
<span><span class="co">#&gt; oo$ageRatioOut, : warning, low sample size of adult females in at least one</span></span>
<span><span class="co">#&gt; year</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span>
<span><span class="co">#&gt; Warning in caribouBayesianIPM(survData = oo$simSurvObs, ageRatio =</span></span>
<span><span class="co">#&gt; oo$ageRatioOut, : warning, low sample size of adult females in at least one</span></span>
<span><span class="co">#&gt; year</span></span>
<span><span class="co">#&gt; using Kaplan-Meier survival model</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plotRes.html">plotRes</a></span><span class="op">(</span><span class="va">scResults</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Recruitment"</span>, <span class="st">"Adult female survival"</span>, <span class="st">"Population growth rate"</span><span class="op">)</span>, </span>
<span>        facetVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rQuantile"</span>, <span class="st">"sQuantile"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Recruitment</span></span></code></pre></div>
<p><img src="BayesianDemographicProjection_files/figure-html/many-scns-1.png" width="672"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Adult female survival`</span></span></code></pre>
<p><img src="BayesianDemographicProjection_files/figure-html/many-scns-2.png" width="672"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Population growth rate`</span></span></code></pre>
<p><img src="BayesianDemographicProjection_files/figure-html/many-scns-3.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="modifying-bayesian-model-priors">Modifying Bayesian model priors<a class="anchor" aria-label="anchor" href="#modifying-bayesian-model-priors"></a>
</h4>
<p>By default <code><a href="../reference/caribouBayesianIPM.html">caribouBayesianIPM()</a></code> calls
<code><a href="../reference/getPriors.html">getPriors()</a></code> internally to set the priors for the Bayesian
model based on the national model and default uncertainty modifiers that
have been calibrated to fit the national model while allowing for
deviations based on local data. The parameters to
<code><a href="../reference/getPriors.html">getPriors()</a></code> affect the level of uncertainty around the
coefficients from the national model. If uncertainty in the national
model is higher then the projections can deviate more from the national
model if the observed data does. See <code><a href="../reference/getPriors.html">getPriors()</a></code> for
details.</p>
</div>
</div>
<div class="section level3">
<h3 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h3>
<p>The national model results are cached if the default values are used.
This cache can be updated by running
<code>getSimsNational(forceUpdate = TRUE)</code></p>
</div>
<div class="section level2">
<h2 id="use-the-bayesian-demographic-projection-app">Use the Bayesian demographic projection app<a class="anchor" aria-label="anchor" href="#use-the-bayesian-demographic-projection-app"></a>
</h2>
<p>In addition to performing Bayesian demographic projections in R you
can also use our shiny app to run similar analyses from a Graphical User
Interface. To launch the app you will first need to install the package
from GitHub.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"LandSciTech/BayesianCaribouDemographicProjection"</span><span class="op">)</span></span></code></pre></div>
<p>Then you can call <code><a href="../reference/demographicProjectionApp.html">demographicProjectionApp()</a></code> to launch
the app in your default browser. The app includes options to modify the
disturbance scenario, the simulated observations and the model priors
similar to those described above. Detailed instructions are included on
the first page.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Josie Hughes, Sarah Endicott, Craig Simpkins, Tati Michelleti, Eliot McIntire.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
