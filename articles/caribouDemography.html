<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Caribou Demography • caribouMetrics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Caribou Demography">
<meta property="og:description" content="caribouMetrics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caribouMetrics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/BayesianDemographicProjection.html">Bayesian Demographic Projection</a>
    </li>
    <li>
      <a href="../articles/UI_help.html">User Interface Help</a>
    </li>
    <li>
      <a href="../articles/Using_caribouHabitat.html">Using caribouHabitat</a>
    </li>
    <li>
      <a href="../articles/Using_disturbanceMetric.html">Disturbance Metrics</a>
    </li>
    <li>
      <a href="../articles/caribouDemography.html">Caribou Demography</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LandSciTech/caribouMetrics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Caribou Demography</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LandSciTech/caribouMetrics/blob/HEAD/vignettes/caribouDemography.Rmd" class="external-link"><code>vignettes/caribouDemography.Rmd</code></a></small>
      <div class="hidden name"><code>caribouDemography.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>caribouMetrics includes a population and demographic model that
allows users to predict demographic rates for a given level of
disturbance and project population growth over time. Demographic rates
are predicted using model coefficients published in <a href="doi:10.1111/1365-2664.13637">Johnson et. al. (2020)</a>.
Population growth is projected using a two-stage demographic model with
density dependence and interannual variability based on Johnson et.
al. (2020) but with some modifications as described in <a href="https://doi.org/10.1101/2022.06.01.494350" class="external-link">Dyson et
al. (2022)</a>.</p>
<p><code><a href="../reference/demographicCoefficients.html">demographicCoefficients()</a></code> selects the regression
coefficient values and standard errors for the desired model version
(see <code>popGrowthTableJohnsonECCC</code> for options) and then
samples coefficients from these Gaussian distributions for each
replicate population.</p>
<p>Next <code><a href="../reference/demographicRates.html">demographicRates()</a></code> is used to apply the sampled
coefficients to the disturbance covariates to calculate the expected
recruitment (<span class="math inline">\(\bar{R}_t\)</span>) and
survival (<span class="math inline">\(\bar{S}_t\)</span>) according to
the beta regression models estimated by Johnson et al. (2020): :<span class="math display">\[\bar{R}_t \sim
Beta(\mu^R_t,\phi^R);log(\mu^R_t)=\dot{\beta^R_0}+\dot{\beta^R_a}A_t+\dot{\beta}^R_fF_t,\]</span></p>
<p><span class="math display">\[\bar{S}_t \sim (46\times
Beta(\mu^S_t,\phi^S)-0.5)/45;log(\mu^S_t)=\dot{\beta^S_0}+\dot{\beta^S_a}A_t.\]</span>
<span class="math inline">\(\phi^R\)</span> and <span class="math inline">\(\phi^S\)</span> are the precisions of the Beta
distributed errors. Each population is optionally assigned to quantiles
of the Beta error distributions for survival and recruitment. Using
quantiles means that the population will stay in these quantiles as
disturbance changes over time, so there is persistent variation in
recruitment and survival among example populations.</p>
<p>Finally, we can use the estimated demographic rates given the amount
of disturbance to project the population growth rate under these
conditions. This is accomplished with an implementation of the 2-stage
population growth model used in Johnson et al. (2020) but with some
differences described in Dyson et al. (2022). The number of
post-juvenile females that survive from year <span class="math inline">\(t\)</span> to the census <span class="math inline">\(\dot{W}_t\)</span> is binomially distributed with
survival probability <span class="math inline">\(\dot{S}_t\)</span>:
<span class="math inline">\(\dot{W}_{t} \sim
\text{Binomial}(\dot{N}_t,\dot{S}_t)\)</span>. Maximum potential
recruitment rate is adjusted for sex ratio and (optionally) delayed age
at first reproduction <span class="math display">\[\dot{X}_t=\frac{\dot{R}_t/2}{1+\dot{R}_t/2}.\]</span>
Realized recruitment rate varies with population density, and the number
of juveniles recruiting to the post-juvenile class at the census is a
binomially distributed function of the number of surviving post-juvenile
females and the adjusted recruitment rate: <span class="math display">\[\dot{J}_{t} \sim
\text{Binomial}(\dot{W}_t,\dot{X}_t[p_0-(p_0-p_k)(\frac{\dot{W}_t}{N_0k})^b]\frac{\dot{W}_t}{\dot{W}_t+a}).\]</span>
Given defalut parameters, recruitment rate is lowest <span class="math inline">\((0.5\dot{X}_t)\)</span> when <span class="math inline">\(\dot{N}_t=1\)</span>, approaches a maximum of
<span class="math inline">\(\dot{X}_t\)</span> at intermediate
population sizes, and declines to <span class="math inline">\(0.6\dot{X}_t\)</span> as the population reaches
carrying capacity of <span class="math inline">\(K=100\)</span> times
the initial population size. The post-juvenile female population in the
next year includes both survivors and new recruits: <span class="math inline">\(\dot{N}_{t+1}=\text{min}(\dot{W}_t+\dot{J}_t,r_{max}\dot{N}_t)\)</span>.</p>
<p>Interannual variation in survival and recruitment is modelled using
truncated beta distributions [rtrunc function; <span class="citation">@novomestky_package_2016</span>]: <span class="math inline">\(\dot{R}_t \sim
\text{TruncatedBeta}(\bar{R}_t,\nu_R,l_R,h_R); \dot{S}_t \sim
\text{TruncatedBeta}(\bar{S}_t,\nu_S,l_S,h_S)\)</span>. Coefficients of
variation among years <span class="math inline">\((\nu_R,\nu_S)\)</span>
and maximum/minimum values <span class="math inline">\(l_R,h_R,l_S,h_S\)</span> for recruitment and
survival are set to default parameters in the function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://landscitech.github.io/caribouMetrics">caribouMetrics</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pthBase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"caribouMetrics"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simple-demographic-projection-for-a-single-example-landscape">Simple demographic projection for a single example landscape<a class="anchor" aria-label="anchor" href="#simple-demographic-projection-for-a-single-example-landscape"></a>
</h2>
<p>A simple case for demographic projection is multiple stochastic
projections from a single landscape that does not change over time.</p>
<p>First we define a disturbance scenario with 40% anthropogenic
disturbance and 2% fire disturbance. If we had spatial data for the
disturbance in our area of interest we could use
<code><a href="../reference/disturbanceMetrics.html">disturbanceMetrics()</a></code> to directly calculate the disturbance.
(See <a href="https://landscitech.github.io/caribouMetrics/articles/Using_disturbanceMetrics.html">Disturbance
Metrics</a> vignette for an example).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disturbance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Anthro <span class="op">=</span> <span class="fl">40</span>, fire_excl_anthro <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>We begin by sampling coefficients for 500 replicate populations using
default Johnson et al. (2020) models “M1” and “M4”. The returned object
is a list containing the coefficients and standard errors from the
national model as well as the sampled coefficients and the quantiles
that they have been assigned to.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popGrowthPars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicCoefficients.html">demographicCoefficients</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">popGrowthPars</span><span class="op">$</span><span class="va">coefSamples_Survival</span><span class="op">$</span><span class="va">coefSamples</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Intercept        Anthro Precision</span></span>
<span><span class="co">#&gt; [1,] -0.1520295 -0.0008241656  79.41793</span></span>
<span><span class="co">#&gt; [2,] -0.1467973 -0.0007818032  55.30423</span></span>
<span><span class="co">#&gt; [3,] -0.1398327 -0.0006629473  80.70902</span></span>
<span><span class="co">#&gt; [4,] -0.1336733 -0.0006685072  63.58602</span></span>
<span><span class="co">#&gt; [5,] -0.1387310 -0.0005633004  68.27663</span></span>
<span><span class="co">#&gt; [6,] -0.1387960 -0.0008918640  77.06096</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">popGrowthPars</span><span class="op">$</span><span class="va">coefSamples_Survival</span><span class="op">$</span><span class="va">coefValues</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Intercept Anthro Precision</span></span>
<span><span class="co">#&gt; 1:    -0.142 -8e-04  63.43724</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">popGrowthPars</span><span class="op">$</span><span class="va">coefSamples_Survival</span><span class="op">$</span><span class="va">coefStdErrs</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Intercept      Anthro Precision</span></span>
<span><span class="co">#&gt; 1: 0.007908163 0.000127551  8.272731</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">popGrowthPars</span><span class="op">$</span><span class="va">coefSamples_Survival</span><span class="op">$</span><span class="va">quantiles</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8226954 0.1201904 0.6494489 0.8969439 0.6285070 0.1125752</span></span></code></pre></div>
<p>Next we calculate sample demographic rates given sampled model
coefficients and disturbance metrics for our example landscape, setting
<code>returnSample = TRUE</code> so that the results returned contain a
row for each sample in each scenario. We set the initial population size
for each sample population to 100, and project population dynamics for
20 years using the <code>caribouPopGrowth</code> function with default
parameter values. Anthropogenic disturbance is high on this example
landscape, so the projected population growth rate for most sample
populations is below 1, but uncertainty in the model means that a few
sample populations persist.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rateSamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicRates.html">demographicRates</a></span><span class="op">(</span></span>
<span>  covTable <span class="op">=</span> <span class="va">disturbance</span>,</span>
<span>  popGrowthPars <span class="op">=</span> <span class="va">popGrowthPars</span>,</span>
<span>  ignorePrecision <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnSample <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  useQuantiles <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>     </span>
<span><span class="va">rateSamples</span><span class="op">$</span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">demography</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rateSamples</span>,</span>
<span>                    <span class="fu"><a href="../reference/caribouPopGrowth.html">caribouPopGrowth</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">rateSamples</span><span class="op">$</span><span class="va">N0</span>,</span>
<span>                                     numSteps <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                     R_bar <span class="op">=</span> <span class="va">rateSamples</span><span class="op">$</span><span class="va">R_bar</span>,</span>
<span>                                     S_bar <span class="op">=</span> <span class="va">rateSamples</span><span class="op">$</span><span class="va">S_bar</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">demography</span>, <span class="op">!</span><span class="op">(</span><span class="va">scnID</span><span class="op">:</span><span class="va">replicate</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">N0</span>, names_to <span class="op">=</span> <span class="st">"Metric"</span>,</span>
<span>                    values_to <span class="op">=</span> <span class="st">"Amount"</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Anthro</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">Amount</span>, </span>
<span>                      colour <span class="op">=</span> <span class="va">fire_excl_anthro</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">2</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html" class="external-link">position_jitterdodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Metric</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Anthro"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></code></pre></div>
<p><img src="caribouDemography_files/figure-html/plotSimpleDemography-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="effects-of-disturbance-on-demographic-rates">Effects of disturbance on demographic rates<a class="anchor" aria-label="anchor" href="#effects-of-disturbance-on-demographic-rates"></a>
</h2>
<p>We can project demographic rates over a range of landscape conditions
to recreate figures 3 and 5 from Johnson et al. (2020) and see the
effects of changing disturbance on model behaviour. First we create a
table of disturbance scenarios across a range of different levels of
fire and anthropogenic disturbance.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covTableSim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>Anthro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                           fire_excl_anthro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">covTableSim</span><span class="op">$</span><span class="va">Total_dist</span> <span class="op">=</span> <span class="va">covTableSim</span><span class="op">$</span><span class="va">Anthro</span> <span class="op">+</span> <span class="va">covTableSim</span><span class="op">$</span><span class="va">fire_excl_anthro</span></span></code></pre></div>
<p>We again sample coefficients from default models M1 and M4. The
sample of 500 is used to calculate averages, while the sample of 35 is
used to show variability among populations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popGrowthPars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicCoefficients.html">demographicCoefficients</a></span><span class="op">(</span></span>
<span>  <span class="fl">500</span>,</span>
<span>  modelVersion <span class="op">=</span> <span class="st">"Johnson"</span>,</span>
<span>  survivalModelNumber <span class="op">=</span> <span class="st">"M1"</span>,</span>
<span>  recruitmentModelNumber <span class="op">=</span> <span class="st">"M4"</span>,</span>
<span>  populationGrowthTable <span class="op">=</span> <span class="va">popGrowthTableJohnsonECCC</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">popGrowthParsSmall</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicCoefficients.html">demographicCoefficients</a></span><span class="op">(</span></span>
<span>  <span class="fl">35</span>,</span>
<span>  modelVersion <span class="op">=</span> <span class="st">"Johnson"</span>,</span>
<span>  survivalModelNumber <span class="op">=</span> <span class="st">"M1"</span>,</span>
<span>  recruitmentModelNumber <span class="op">=</span> <span class="st">"M4"</span>,</span>
<span>  populationGrowthTable <span class="op">=</span> <span class="va">popGrowthTableJohnsonECCC</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next we calculate demographic rates given sampled model coefficients.
For the smaller sample we set <code>returnSample = TRUE</code> so that
the results returned contain a row for each sample in each scenario.
Setting <code>useQuantiles = TRUE</code> assigns each sample population
to a quantile of the regression model error distributions for survival
and recruitment, which allows us to see how demographic rates change.
For the larger sample we set <code>returnSample = FALSE</code> and the
result has one row for each scenario and includes summary statistics of
the uncertainty across the samples. We do this twice, once with
<code>ignorePrecision = TRUE</code> and once with
<code>ignorePrecision = FALSE</code> to demonstrate the effect of
considering the variance among populations around the National mean in
addition to the uncertainty about the coefficient estimates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rateSamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicRates.html">demographicRates</a></span><span class="op">(</span></span>
<span>  covTable <span class="op">=</span> <span class="va">covTableSim</span>,</span>
<span>  popGrowthPars <span class="op">=</span> <span class="va">popGrowthParsSmall</span>,</span>
<span>  ignorePrecision <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnSample <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  useQuantiles <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rateSummaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicRates.html">demographicRates</a></span><span class="op">(</span></span>
<span>  covTable <span class="op">=</span> <span class="va">covTableSim</span>,</span>
<span>  popGrowthPars <span class="op">=</span> <span class="va">popGrowthPars</span>,</span>
<span>  ignorePrecision <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnSample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  useQuantiles <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rateSummariesIgnorePrecision</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicRates.html">demographicRates</a></span><span class="op">(</span></span>
<span>  covTable <span class="op">=</span> <span class="va">covTableSim</span>,</span>
<span>  popGrowthPars <span class="op">=</span> <span class="va">popGrowthPars</span>,</span>
<span>  ignorePrecision <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnSample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  useQuantiles <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="no-precision">No precision<a class="anchor" aria-label="anchor" href="#no-precision"></a>
</h3>
<p>The Johnson et al. (2020) model with parameter uncertainty but no
precision. The bands are the 2.5% and 97.5% quantiles of 500 sample
parameter values.
<img src="caribouDemography_files/figure-html/parameterUncertaintyOnly-1.png" width="768"><img src="caribouDemography_files/figure-html/parameterUncertaintyOnly-2.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="with-precision">With precision<a class="anchor" aria-label="anchor" href="#with-precision"></a>
</h3>
<p>The Johnson et al. (2020) model with parameter uncertainty and
precision. Faint coloured lines show example trajectories of expected
demographic rates in sample populations, assuming each sample population
is randomly distributed among quantiles of the beta distribution, and
each population remains in the same quantile of the beta distribution as
disturbance changes.</p>
<pre><code><span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="caribouDemography_files/figure-html/withPrecision-1.png" width="768"><img src="caribouDemography_files/figure-html/withPrecision-2.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="projection-of-population-growth-over-time-on-a-changing-landscape">Projection of population growth over time on a changing
landscape<a class="anchor" aria-label="anchor" href="#projection-of-population-growth-over-time-on-a-changing-landscape"></a>
</h2>
<p>In this example, we project 35 sample populations for 50 years on a
landscape where the anthropogenic disturbance footprint is increasing by
5% per decade. We set <code>interannualVar = FALSE</code>,
<code>K = FALSE</code>, and <code>probOption = "continuous"</code> to
use a simpler 2-stage demographic model without interannual variability,
density dependence, or discrete numbers of animals, as in Stewart et
al. in prep.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numTimesteps</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">stepLength</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">AnthroChange</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co">#For illustration assume 5% increase in anthropogenic disturbance footprint each decade</span></span>
<span></span>
<span><span class="co"># at each time,  sample demographic rates and project, save results</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>N0 <span class="op">=</span> <span class="va">N0</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numTimesteps</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">covariates</span> <span class="op">&lt;-</span> <span class="va">disturbance</span></span>
<span>  <span class="va">covariates</span><span class="op">$</span><span class="va">Anthro</span> <span class="op">&lt;-</span> <span class="va">covariates</span><span class="op">$</span><span class="va">Anthro</span> <span class="op">+</span> <span class="va">AnthroChange</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">rateSamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demographicRates.html">demographicRates</a></span><span class="op">(</span></span>
<span>    covTable <span class="op">=</span> <span class="va">covariates</span>,</span>
<span>    popGrowthPars <span class="op">=</span> <span class="va">popGrowthParsSmall</span>,</span>
<span>    ignorePrecision <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    returnSample <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    useQuantiles <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">is.element</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pars</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">replicate</span>, <span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span> <span class="op">==</span> <span class="st">"N"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"N0"</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">pars</span>, <span class="va">rateSamples</span><span class="op">)</span></span>
<span>  <span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pars</span>, </span>
<span>                <span class="fu"><a href="../reference/caribouPopGrowth.html">caribouPopGrowth</a></span><span class="op">(</span><span class="va">pars</span><span class="op">$</span><span class="va">N0</span>,</span>
<span>                                 R_bar <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">R_bar</span>, S_bar <span class="op">=</span> <span class="va">pars</span><span class="op">$</span><span class="va">S_bar</span>,</span>
<span>                                 numSteps <span class="op">=</span> <span class="va">stepLength</span>, interannualVar <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                 K <span class="op">=</span> <span class="cn">FALSE</span>, probOption <span class="op">=</span> <span class="st">"continuous"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># add results to output set</span></span>
<span>  <span class="va">fds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pars</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">replicate</span>, <span class="va">Anthro</span>, <span class="va">S_bar</span>, <span class="va">R_bar</span>, <span class="va">N</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">fds</span><span class="op">$</span><span class="va">replicate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">""</span>, <span class="va">fds</span><span class="op">$</span><span class="va">replicate</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Replicate"</span>, <span class="st">"anthro"</span>, <span class="st">"survival"</span>, <span class="st">"recruitment"</span>, <span class="st">"N"</span>, <span class="st">"lambda"</span><span class="op">)</span></span>
<span>  <span class="va">fds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">fds</span>, <span class="op">!</span><span class="va">Replicate</span>, names_to <span class="op">=</span> <span class="st">"MetricTypeID"</span>, values_to <span class="op">=</span> <span class="st">"Amount"</span><span class="op">)</span></span>
<span>  <span class="va">fds</span><span class="op">$</span><span class="va">Timestep</span> <span class="op">&lt;-</span> <span class="va">t</span> <span class="op">*</span> <span class="va">stepLength</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">t</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">popMetrics</span> <span class="op">&lt;-</span> <span class="va">fds</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">popMetrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">popMetrics</span>, <span class="va">fds</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">popMetrics</span><span class="op">$</span><span class="va">MetricTypeID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">popMetrics</span><span class="op">$</span><span class="va">MetricTypeID</span><span class="op">)</span></span>
<span><span class="va">popMetrics</span><span class="op">$</span><span class="va">Replicate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="va">popMetrics</span><span class="op">$</span><span class="va">Replicate</span><span class="op">)</span></span>
<span><span class="va">popMetrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">popMetrics</span>, <span class="op">!</span><span class="va">MetricTypeID</span> <span class="op">==</span> <span class="st">"N"</span><span class="op">)</span></span></code></pre></div>
<p><img src="caribouDemography_files/figure-html/changeOverTime-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Dyson, M., Endicott, S., Simpkins, C., Turner, J. W., Avery-Gomm, S.,
Johnson, C. A., Leblond, M., Neilson, E. W., Rempel, R., Wiebe, P. A.,
Baltzer, J. L., Stewart, F. E. C., &amp; Hughes, J. (in press). Existing
caribou habitat and demographic models need improvement for Ring of Fire
impact assessment: A roadmap for improving the usefulness, transparency,
and availability of models for conservation. <a href="https://doi.org/10.1101/2022.06.01.494350" class="external-link uri">https://doi.org/10.1101/2022.06.01.494350</a></p>
<p>Johnson, C.A., Sutherland, G.D., Neave, E., Leblond, M., Kirby, P.,
Superbie, C. and McLoughlin, P.D., 2020. Science to inform policy:
linking population dynamics to habitat for a threatened species in
Canada. Journal of Applied Ecology, 57(7), pp.1314-1327. <a href="https://doi.org/10.1111/1365-2664.13637" class="external-link uri">https://doi.org/10.1111/1365-2664.13637</a></p>
<p>Stewart, F.E., Micheletti, T., Cumming, S.G., Barros, C., Chubaty,
A.M., Dookie, A.L., Duclos, I., Eddy, I., Haché, S., Hodson, J. and
Hughes, J., 2023. Climate‐informed forecasts reveal dramatic local
habitat shifts and population uncertainty for northern boreal caribou.
Ecological Applications, 33(3), p.e2816.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Josie Hughes, Sarah Endicott, Craig Simpkins, Tati Michelleti, Eliot McIntire.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
